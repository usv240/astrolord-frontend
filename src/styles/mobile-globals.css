/**
 * Mobile-Optimized CSS Variables & Global Styles
 * Add this to your global CSS or create a separate mobile-globals.css
 * 
 * Purpose: Centralized mobile styles including:
 * - Safe area variables
 * - Touch target baseline styles
 * - Responsive typography
 * - Mobile-friendly form styling
 * - Keyboard-safe spacing
 */

/* ============================================================================
   SAFE AREA INSETS - For notched devices (iPhone, Android)
   ============================================================================ */
:root {
  --safe-area-inset-top: env(safe-area-inset-top, 0);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0);
  --safe-area-inset-left: env(safe-area-inset-left, 0);
  --safe-area-inset-right: env(safe-area-inset-right, 0);
  
  /* Viewport adjustment for keyboard (approximate) */
  --keyboard-height: 0;
  --viewport-height: 100vh;
}

/* ============================================================================
   MOBILE BASE STYLES
   ============================================================================ */

/* HTML root with proper viewport settings */
html {
  /* Prevent zoom on input focus */
  font-size: 16px;
  
  /* Support safe area insets */
  padding-top: var(--safe-area-inset-top);
  padding-bottom: var(--safe-area-inset-bottom);
  padding-left: var(--safe-area-inset-left);
  padding-right: var(--safe-area-inset-right);
}

/* Body optimization */
body {
  /* Ensure full viewport height */
  min-height: 100vh;
  min-height: 100dvh; /* Dynamic viewport height (mobile) */
  
  /* Smooth scrolling on mobile */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  
  /* Prevent text selection issues on tap */
  -webkit-user-select: none;
  user-select: none;
  
  /* Fix viewport meta for iOS */
  -webkit-touch-callout: none;
}

/* Allow text selection in input/textarea */
input, textarea, [role="textbox"] {
  -webkit-user-select: text;
  user-select: text;
}

/* ============================================================================
   TOUCH TARGET OPTIMIZATION (44px minimum)
   ============================================================================ */

button,
a[role="button"],
[role="button"],
input[type="button"],
input[type="submit"],
input[type="reset"] {
  /* Ensure minimum touch target */
  min-height: 44px;
  min-width: 44px;
  
  /* Remove default browser styling */
  -webkit-appearance: none;
  appearance: none;
  
  /* Better tap feedback */
  cursor: pointer;
}

/* Icon buttons (square) */
button[aria-label] {
  min-height: 44px;
  aspect-ratio: 1;
}

/* ============================================================================
   FORM OPTIMIZATION FOR MOBILE KEYBOARDS
   ============================================================================ */

input,
textarea,
select {
  /* Prevent zoom on focus (keep font size >= 16px on mobile) */
  font-size: 16px;
  
  /* Improve touch experience */
  padding: 12px;
  border-radius: 8px;
  
  /* Fix iOS input styling */
  -webkit-appearance: none;
  appearance: none;
  -webkit-border-radius: 8px;
  
  /* Remove background color from autofill */
  background-color: transparent;
  
  /* Better visual feedback */
  transition: border-color 0.2s, box-shadow 0.2s;
}

/* Specific input improvements */
input[type="text"],
input[type="email"],
input[type="phone"],
input[type="number"],
input[type="date"],
textarea {
  width: 100%;
  box-sizing: border-box;
}

/* Textarea - ensure vertical scrolling */
textarea {
  resize: vertical;
  min-height: 100px;
  overflow-y: auto;
  
  /* Keep keyboard accessible space */
  margin-bottom: max(1rem, env(safe-area-inset-bottom));
}

/* Remove spinner from number input */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type="number"] {
  -moz-appearance: textfield;
}

/* Select improvements */
select {
  padding: 12px;
  cursor: pointer;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M0 3l6 6 6-6z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  padding-right: 36px;
  background-size: 12px 12px;
}

/* Focus states for accessibility */
input:focus,
textarea:focus,
select:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
}

/* ============================================================================
   MODAL & DIALOG OPTIMIZATION
   ============================================================================ */

/* Modal backdrop */
[role="dialog"],
dialog {
  /* Prevent scroll behind modal */
  position: fixed;
  
  /* Optimal mobile sizing */
  max-width: 95vw;
  max-height: 90vh;
  width: 100%;
  
  /* Adjust for keyboard */
  bottom: auto;
  max-height: calc(100dvh - env(safe-area-inset-bottom, 0px));
}

/* Modal overlay */
[role="dialog"]::backdrop,
dialog::backdrop {
  background-color: rgba(0, 0, 0, 0.5);
}

/* Centered modals on mobile */
@media (max-width: 767px) {
  [role="dialog"],
  dialog {
    bottom: 0;
    border-radius: 16px 16px 0 0; /* Bottom sheet style */
  }
}

/* ============================================================================
   NAVIGATION OPTIMIZATION
   ============================================================================ */

/* Navigation items with proper touch targets */
[role="navigation"] a,
[role="navigation"] button {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 48px;
  padding: 12px;
  transition: background-color 0.2s;
}

/* Bottom navigation bar */
nav[aria-label="mobile"],
.mobile-nav,
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  
  /* Safe area support */
  padding-bottom: env(safe-area-inset-bottom);
  
  /* Ensure above content */
  z-index: 40;
  
  /* Prevent overlap with content */
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  background: white;
}

/* Account for bottom nav */
body.has-bottom-nav {
  padding-bottom: max(64px, calc(64px + env(safe-area-inset-bottom)));
}

/* ============================================================================
   RESPONSIVE TYPOGRAPHY
   ============================================================================ */

/* Headings scale appropriately */
h1 {
  font-size: clamp(24px, 5vw, 48px);
  line-height: 1.2;
}

h2 {
  font-size: clamp(20px, 4vw, 36px);
}

h3 {
  font-size: clamp(18px, 3vw, 28px);
}

p, body {
  font-size: 16px; /* Minimum to prevent zoom on focus */
  line-height: 1.5;
}

small, .text-sm {
  font-size: 14px;
}

/* ============================================================================
   SCROLL BEHAVIOR
   ============================================================================ */

/* Smooth scroll on supported browsers */
html {
  scroll-behavior: smooth;
}

/* Remove scroll-behavior for elements with fixed positioning */
.modal-open html {
  scroll-behavior: auto;
}

/* Improve scrolling performance */
.scrollable {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
}

/* ============================================================================
   LINK & BUTTON STATES
   ============================================================================ */

/* Remove default tap highlight color */
a, button, input {
  -webkit-tap-highlight-color: transparent;
}

/* Better hover/active states on touch */
@media (hover: none) {
  /* No hover support (touch devices) */
  a:hover,
  button:hover {
    background-color: inherit;
  }
  
  a:active,
  button:active {
    opacity: 0.8;
  }
}

@media (hover: hover) {
  /* Has hover support (desktop) */
  a:hover,
  button:hover {
    opacity: 0.8;
  }
}

/* ============================================================================
   UTILITY CLASSES FOR MOBILE
   ============================================================================ */

/* Safe area padding helpers */
.safe-area-top {
  padding-top: var(--safe-area-inset-top);
}

.safe-area-bottom {
  padding-bottom: max(1rem, var(--safe-area-inset-bottom));
}

.safe-area-left {
  padding-left: var(--safe-area-inset-left);
}

.safe-area-right {
  padding-right: var(--safe-area-inset-right);
}

.safe-area-all {
  padding: var(--safe-area-inset-top) var(--safe-area-inset-right)
           var(--safe-area-inset-bottom) var(--safe-area-inset-left);
}

/* Touch target helpers */
.touch-target {
  min-height: 44px;
  min-width: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* Keyboard safe spacing */
.keyboard-safe {
  margin-bottom: var(--keyboard-height);
  transition: margin-bottom 0.3s ease;
}

/* Hide on mobile */
@media (max-width: 767px) {
  .hide-mobile {
    display: none;
  }
}

/* Hide on desktop */
@media (min-width: 768px) {
  .hide-desktop {
    display: none;
  }
}

/* ============================================================================
   PREVENT COMMON MOBILE ISSUES
   ============================================================================ */

/* Prevent double tap zoom */
a, button {
  touch-action: manipulation;
}

/* Fix iOS input zoom */
input[type="text"],
input[type="email"],
input[type="phone"],
textarea {
  font-size: 16px; /* Prevent auto-zoom */
}

/* Fix iPhone Safari vh issue */
body {
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height */
}

/* Prevent image dragging on mobile */
img {
  -webkit-user-drag: none;
  user-select: none;
}
